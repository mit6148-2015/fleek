<!doctype html>
<html>
<head>
  <title>Network | Selections</title>

  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vis/3.9.0/vis.min.js"></script>
  <link href="vis.css" rel="stylesheet" type="text/css" />

  <style type="text/css">
    #mynetwork {
      width: 100%;
      height: 800px;
      /*border: 1px solid lightgray;*/
    }
    #meDiv {background: white;color:black; 
    width   : 100%;
    height    : 350px;
    font-size : 11px;
  }
  #worldDiv {background: white;color:black; 
    width   : 100%;
    height    : 350px;
    font-size : 11px;
  }
  </style>
  <!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>

<script type="text/javascript" src="http://www.amcharts.com/lib/3/amcharts.js"></script>
<script type="text/javascript" src="http://www.amcharts.com/lib/3/pie.js"></script>
<script type="text/javascript" src="http://www.amcharts.com/lib/3/themes/dark.js"></script>
</head>

<body>
<div class="container-fluid">
   <div class="col-md-8">
    <div id="mynetwork"></div>
    <div id="info"></div>
  </div>
  <div class="col-md-4">
    <div id="meDiv"></div> <br/>
    <div id="worldDiv"></div>
  </div>
</div>

<script type="text/javascript">
  /* LOOK HERE. JUST REPLACE THIS TO READ FROM ALLTAGS.JSON. */

    var tags = [{"parentTags": ["equation","number theory"],"tag": "diophantine equation"}
,{"parentTags": ["proof"],"tag": "proof by contradiction"}
,{"parentTags": ["quadrilateral"],"tag": "kite"}
,{"parentTags": ["polynomial"],"tag": "vieta's formula"}
,{"parentTags": ["polynomial"],"tag": "roots"}
,{"parentTags": ["number theory"],"tag": "prime number"}
,{"parentTags": ["circle"],"tag": "power of a point"}
,{"parentTags": ["equation"],"tag": "proportion"}
,{"parentTags": ["counting"],"tag": "PIE"}
,{"parentTags": ["algebra"],"tag": "coordinates"}
,{"parentTags": ["algebra","number theory"],"tag": "bases"}
,{"parentTags": ["number theory"],"tag": "factor"}
,{"parentTags": ["2D geometry"],"tag": "circle"}
,{"parentTags": ["triangle"],"tag": "pythagorean theorem"}
,{"parentTags": ["algebra"],"tag": "logarithm"}
,{"parentTags": ["3D geometry"],"tag": "cube"}
,{"parentTags": ["polygon"],"tag": "triangle"}
,{"parentTags": ["counting"],"tag": "combinations"}
,{"parentTags": ["trigonometry"],"tag": "trigonometric identity"}
,{"parentTags": ["triangle"],"tag": "triangle center"}
,{"parentTags": ["trigonometry"],"tag": "cosine"}
,{"parentTags": ["statistics"],"tag": "median"}
,{"parentTags": ["statistics"],"tag": "mode"}
,{"parentTags": ["trigonometry"],"tag": "law of sines"}
,{"parentTags": ["statistics"],"tag": "mean"}
,{"parentTags": ["function"],"tag": "domain"}
,{"parentTags": ["trigonometric identity"],"tag": "trigonometry addition formula"}
,{"parentTags": ["algebra"],"tag": "exponent"}
,{"parentTags": ["polynomial","function"],"tag": "cubic"}
,{"parentTags": ["polynomial","number theory"],"tag": "binomial theorem"}
,{"parentTags": ["quadrilateral"],"tag": "squares"}
,{"parentTags": ["proof"],"tag": "induction"}
,{"parentTags": ["fleek"],"tag": "math"}
,{"parentTags": ["science"],"tag": "biology"}
,{"parentTags": ["probability","geometry"],"tag": "geometric probability"}
,{"parentTags": ["algebra"],"tag": "statistics"}
,{"parentTags": ["trigonometry"],"tag": "tangent"}
,{"parentTags": ["circle"],"tag": "incircle"}
,{"parentTags": ["trigonometry"],"tag": "sine"}
,{"parentTags": ["modular arithmetic"],"tag": "remainder"}
,{"parentTags": ["counting"],"tag": "casework counting"}
,{"parentTags": ["number theory"],"tag": "divisor"}
,{"parentTags": ["math"],"tag": "algebra"}
,{"parentTags": ["math"],"tag": "geometry"}
,{"parentTags": ["quadrilateral"],"tag": "rhombus"}
,{"parentTags": ["function"],"tag": "range"}
,{"parentTags": ["geometry"],"tag": "2D geometry"}
,{"parentTags": ["polygon"],"tag": "hexagon"}
,{"parentTags": ["triangle"],"tag": "similar triangles"}
,{"parentTags": ["counting"],"tag": "Venn Diagram"}
,{"parentTags": ["number theory"],"tag": "modular arithmetic"}
,{"parentTags": ["combinatorics"],"tag": "probability"}
,{"parentTags": ["polygon"],"tag": "quadrilateral"}
,{"parentTags": ["polynomial"],"tag": "factoring"}
,{"parentTags": ["algebra"],"tag": "polynomial"}
,{"parentTags": ["polygon"],"tag": "pentagon"}
,{"parentTags": ["algebra"],"tag": "arithmetic sequence"}
,{"parentTags": ["counting"],"tag": "complementary counting"}
,{"parentTags": ["geometry"],"tag": "area"}
,{"parentTags": ["math"],"tag": "combinatorics"}
,{"parentTags": ["polynomial","function","equation"],"tag": "quadratic"}
,{"parentTags": ["algebra"],"tag": "geometric series"}
,{"parentTags": ["geometry"],"tag": "analytic geometry"}
,{"parentTags": ["algebra"],"tag": "function"}
,{"parentTags": ["geometry"],"tag": "congruence"}
,{"parentTags": ["modular arithmetic"],"tag": "chinese remainder theorem"}
,{"parentTags": ["geometry"],"tag": "3D geometry"}
,{"parentTags": ["factor"],"tag": "number of divisors"}
,{"parentTags": ["polynomial","function"],"tag": "quartic"}
,{"parentTags": ["fleek"],"tag": "science"}
,{"parentTags": ["algebra"],"tag": "equation"}
,{"parentTags": ["math"],"tag": "number theory"}
,{"parentTags": ["trigonometry"],"tag": "law of cosines"}
,{"parentTags": ["function"],"tag": "floor function"}
,{"parentTags": ["algebra"],"tag": "trigonometry"}
,{"parentTags": ["math"],"tag": "proof"}
,{"parentTags": ["3D geometry"],"tag": "pyramid"}
,{"parentTags": ["counting"],"tag": "permutations"}
,{"parentTags": ["equation"],"tag": "linear equation"}
,{"parentTags": ["3D geometry"],"tag": "sphere"}
,{"parentTags": ["circle"],"tag": "circumcircle"}
,{"parentTags": ["3D geometry"],"tag": "cone"}
,{"parentTags": ["combinatorics"],"tag": "counting"}
,{"parentTags": ["bases"],"tag": "binary"}
,{"parentTags": ["geometry"],"tag": "angle"}
,{"parentTags": ["2D geometry"],"tag": "polygon"}
,{"parentTags": ["equation"],"tag": "recursion"}
,{"parentTags": ["recursion"],"tag": "fibnoacci numbers"}
,{"parentTags": ["3D geometry"],"tag": "prism"}
,{"parentTags": ["counting"],"tag": "constructive counting"}
,{"parentTags": ["math"],"tag": "arithmetic"}
,{"parentTags": ["geometry"],"tag": "perimeter"}
,{"parentTags": ["circle"],"tag": "arcs"}
,{"parentTags": ["math"],"tag": "logic"}
,{"parentTags": ["polygon"],"tag": "octagon"}
,{"parentTags": ["trigonometric identity"],"tag": "double angle formula"}
,{"parentTags": ["quadrilateral"],"tag": "cyclic quadrilateral"}
,{"parentTags": ["science"],"tag": "chemistry"}
,{"parentTags": ["circle"],"tag": "sectors"}
,{"parentTags": ["circle"],"tag": "chords"}
,{"parentTags": ["factor"],"tag": "greatest common divisor"}
,{"parentTags": ["function"],"tag": "ceiling function"}
,{"parentTags": ["science"],"tag": "physics"}];



// Take all the tags and make an array out of them. This is to prevent duplicates and get ID's.
var allTags = [];
  for (var i = 0; i<tags.length; i++) {
    //console.log(tags[i].tag)
    tagDict = tags[i];
    tagName = tagDict.tag;
    if (allTags.indexOf(tagName)<0){
        allTags.push(tagName);
    }
    parentList = tagDict.parentTags;
    for (var j = 0; j<parentList.length; j++) {
        if (allTags.indexOf(parentList[j])<0){
            allTags.push(parentList[j]);
        }
    }
  }

nodes = []

// Go back, and add the nodes now. 

for (var i = 0; i<allTags.length; i++) {
    var displayButton = "<a class=\"btn btn-default btn-xs\" href=\"#\" role=\"button\"> Find \n"+allTags[i]+" problems</a>";
    nodes.push({id:i, label:allTags[i], title:displayButton});
}

edges = [];

// Now, add the edges. 

  for (var i = 0; i<tags.length; i++) {
    tagDict = tags[i];
    tagName = tagDict.tag;
    firstInd = allTags.indexOf(tagName);
    parentList = tagDict.parentTags;
    for (var j = 0; j<parentList.length; j++) {
        secondInd = allTags.indexOf(parentList[j]);
        edges.push({from:secondInd, to:firstInd});
    }
  }

  // create a network
  var container = document.getElementById('mynetwork');
  var data = {
    nodes: nodes,
    edges: edges
  };


  var options = {
    zoomExtentOnStabilize:false,
    keyboard:true,
    hierarchicalLayout: {
      nodeSpacing:150,
      enabled: true,
      direction: "UD",
      layout: "direction"
    },
    dragNodes:true,
    nodes: {
        color: {
          background: '#ecf0f1',
          border: '#3498db',
          highlight: {
            background: '#3498db',
            border: '#3498db'
          },
          hover: {
            background:'white',
            border: '#3498db'
          }
        },
        shape: 'box'
      }
  };

  network = new vis.Network(container, data, options);

  // add event listener for selection, make charts now. 
  network.on('select', function(properties) {
    /* LOOK HERE. USE THIS VARIABLE TO GET THE RIGHT/WRONG FOR EVERYONE. */
    selectedTag = allTags[properties.nodes[0]];
    //document.getElementById('info').innerHTML += 'selection: ' + selectedTag + '<br>';
    /* LOOK HERE. RETURN THESE WITH THE RIGHT/WRONG THINGEIES. */
    makeChart(selectedTag, 121,123,312,14);
  });

// Make a chart for the right/wrong for the user, and all
function makeChart(tag, meRight, meWrong, worldRight, worldWrong) {
  meTitle = "Is your #" + tag + " on fleek?";
  worldTitle = "Is the world's #" + tag + " on fleek?";
    var chart = AmCharts.makeChart("meDiv", {
      "titles": [
          {
            "text": meTitle,
            "size": 15
          }
        ],
      "color":"black",
      "type": "pie",
      "theme": "dark",
      "dataProvider": [
        { "status": "Correct", "number": meRight},
        {"status": "Wrong","number": meWrong}],
      "valueField": "number",
      "titleField": "status",
      "exportConfig":{  
        menuItems: [{
        icon: '/lib/3/images/export.png',
        format: 'png'   
        }]  
    }
  });

    var chartWorld = AmCharts.makeChart("worldDiv", {
      "titles": [
        {
          "text": worldTitle,
          "size": 15
        }
      ],
      "color":"black",
      "type": "pie",
    "theme": "dark",
      "dataProvider": [
        { "status": "Correct", "number": worldRight},
        {"status": "Wrong","number": worldWrong}],
      "valueField": "number",
      "titleField": "status",
      "exportConfig":{  
        menuItems: [{
        icon: '/lib/3/images/export.png',
        format: 'png'   
        }]  
    }
  });
}

</script>



</body>
</html>
